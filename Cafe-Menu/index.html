<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>QR Menu Armenia | Home</title>

    <style>
      @import url("https://fonts.googleapis.com/css2?family=Playwrite+IT+Trad:wght@100..400&display=swap");

      :root {
        --titleColor: black;
        --btn-text: #f6f6f6;
        --btn-bg: #b35c32;
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        width: 100%;
        height: 100%;
        display: flex;
        justify-content: center;
        align-items: center;
      }

      .main {
        width: 100%;
        min-height: 100vh;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        align-items: center;
        padding: 50px 12px 25px 12px;
        position: relative;
      }

      .main .body-bg {
        width: 100%;
        height: 100%;
        object-fit: cover;
        object-position: center;
        position: absolute;
        top: 0;
        left: 0;
        z-index: -1;
        filter: blur(3px);
        opacity: 0.6;
      }

      .main .banner {
        width: 100%;
        height: auto;
        display: flex;
        justify-content: space-evenly;
        align-items: center;

        .title {
          font-family: Arial, Helvetica, sans-serif;
          font-size: 24px;
          color: var(--titleColor);
          font-weight: 400;
        }

        .languages_cont {
          min-width: 40px;
          min-height: 40px;
          overflow: hidden;
          display: flex;
          flex-direction: column;
          justify-content: flex-end;
          align-items: center;
          gap: 14px;

          img {
            max-width: 40px;
            max-height: 40px;
            object-fit: cover;
            object-position: center center;
          }

          .languages_enabled {
            display: grid;
            gap: 4px;

            button {
              color: black;
              font-weight: 600;
              letter-spacing: 1px;
              cursor: pointer;
              border: none;
              background-color: transparent;
            }
          }

          .languages_disabled {
            display: none;
          }
        }
      }

      .main-page-icon {
        width: 150px;
        height: 150px;
        border-radius: 100%;
      }

      .main .info {
        width: 100%;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        gap: 15px;
      }

      .main .info h1,
      .main .info h3 {
        color: var(--white);
        font-family: Arial, Helvetica, sans-serif;
        font-weight: 400;
      }

      .main .info h1 {
        font-size: 20px;
      }

      .main .info h3 {
        font-size: 16px;
      }

      .main .info a {
        padding: 5px 33px;
        font-size: 24px;
        color: var(--btn-text);
        background-color: var(--btn-bg);
        text-decoration: none;
        border-radius: 4px;
        animation: pulse 1s infinite linear;
      }

      @keyframes pulse {
        0% {
          scale: 1;
        }

        50% {
          scale: 1.2;
        }

        100% {
          scale: 1;
        }
      }

      .main {
        .footer_content {
          display: flex;
          flex-direction: column;
          gap: 12px;

          .payment-methods {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
          }

          .payment-methods img {
            margin: 0 10px;
            height: 20px; /* Adjust image size */
          }

          .footer-links {
            text-align: center;
            margin-bottom: 10px;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            align-items: center;
            gap: 12px;
          }

          .footer-links button {
            background-color: transparent;
            font-size: 10px;
            border: none;
            color: white;
          }

          .copyright {
            text-align: center;
            font-size: 8px;
            color: aliceblue;
          }
        }
      }
    </style>
  </head>
  <body>
    <section class="main">
      <img alt="" id="body-bg" class="body-bg" />
      <div class="banner">
        <h1 class="title" id="r-title"></h1>
        <div class="languages_cont">
          <img src="/api/static/icons/globe.svg" alt="Globe" id="lang_btn" />

          <div class="languages_disabled" id="languages_cont">
            <button data-lang="en" class="lang">English</button>
            <button data-lang="ru" class="lang">Русский</button>
            <button data-lang="hy" class="lang">Հայերեն</button>
          </div>
        </div>
      </div>
      <div class="info">
        <!-- <h1 id="welcome-message"></h1> -->
        <a
          href="https://qrmenuarmenia.site/api/cafe/menu/get-menu"
          id="menu_btn"
        >
          Menu
        </a>
        <!-- <a href="pages/menu.html" id="menu_btn">Menu</a> -->
      </div>
      <img alt="Cafe Logo" class="main-page-icon" id="r-logo" />

      <div class="footer_content">
        <div class="payment-methods">
          <img
            src="/api/static/images/Cafe Menu Images/idramLogo.webp"
            alt="Idarm Logo"
          />
          <img
            src="/api/static/images/Cafe Menu Images/visaLogo.webp"
            alt="Visa Logo"
          />
          <img
            src="/api/static/images/Cafe Menu Images/arca.webp"
            alt="Arca Logo"
          />
          <img
            src="/api/static/images/Cafe Menu Images/mastercardLogo.png"
            alt="MasterCard Logo"
          />
        </div>

        <div class="footer-links">
          <button class="terms" id="privacy_policy">Privacy Policy</button>
          <button class="terms" id="cancellation_policy">
            Cancellation Policy
          </button>
          <button class="terms" id="terms_of_use">Terms of Use</button>
          <button class="terms" id="personal_data">Personal Data</button>
        </div>

        <div class="copyright">
          <p id="copyright_text">Loading ...</p>
        </div>
      </div>
    </section>

    <!-- Only the <script> section is shown with corrections -->
    <script>
      const terms_buttons = document.querySelectorAll(".terms");
      const copyright_text = document.getElementById("copyright_text");
      copyright_text.innerText = `© ${new Date().getFullYear()} Your Company. All rights reserved.`;

      const currentURL = window.location.href;
      const segments = currentURL.split("/");
      const indexURL = segments[segments.length - 1];

      const bodyBg = document.getElementById("body-bg");
      const rTitle = document.getElementById("r-title");
      const rLogo = document.getElementById("r-logo");
      const lang_btn = document.getElementById("lang_btn");
      const languages = document.querySelectorAll(".lang");
      const languages_cont = document.getElementById("languages_cont");
      const menu_btn = document.getElementById("menu_btn");

      lang_btn.addEventListener("click", () => {
        if (languages_cont.className === "languages_enabled") {
          languages_cont.className = "languages_disabled";
        } else languages_cont.className = "languages_enabled";
      });

      languages.forEach((lang) => {
        lang.addEventListener("click", async () => {
          const selectedLang = lang.getAttribute("data-lang");
          try {
            const response = await fetch("/api/data/get-index-json");
            const data = await response.json();

            menu_btn.innerText = data.button[selectedLang];
            terms_buttons.forEach((btn, index) => {
              btn.innerText = data.terms[selectedLang][index];
            });
            copyright_text.innerText = `© ${new Date().getFullYear()} QR Menu Armenia. ${
              data.footer[selectedLang]
            }.`;

            localStorage.setItem("language", selectedLang);
          } catch (error) {
            console.error("Error fetching data: ", error);
          }
        });
      });

      async function defaultPageLanguege() {
        let lang = localStorage.getItem("language") || "en"; // fallback
        try {
          const response = await fetch("/api/data/get-index-json");
          const data = await response.json();

          menu_btn.innerText = data.button[lang];
          terms_buttons.forEach((btn, index) => {
            btn.innerText = data.terms[lang][index];
          });
          copyright_text.innerText = `© ${new Date().getFullYear()} QR Menu Armenia. ${
            data.footer[lang]
          }.`;
        } catch (error) {
          console.error("Error fetching data: ", error);
        }
      }

      localStorage.setItem("cafeIdIndex", indexURL);

      async function FetchingAPI(link) {
        try {
          const response = await fetch(link);
          const data = await response.json();

          bodyBg.src = data.image_src;
          rTitle.innerText = data.name;
          rLogo.src = data.logo;
        } catch (error) {
          console.log("Error fetching URL", error);
        }
      }

      FetchingAPI(
        `https://qrmenuarmenia.site/api/api/menu-filter/by-horekaclient-id/${indexURL}`
      );

      terms_buttons.forEach((button) => {
        button.addEventListener("click", async () => {
          let term = button.id;
          let lang = localStorage.getItem("language") || "en";

          try {
            const link = `https://qrmenuarmenia.site/api/cafe/menu/users/${term}/${lang}`;
            await fetch(link, {
              method: "GET",
              headers: {
                "Content-Type": "text/html",
              },
            });
            window.open(link, "_blank");
          } catch (error) {
            console.log("Error getting data: ", error);
          }
        });
      });

      window.addEventListener("DOMContentLoaded", defaultPageLanguege);
    </script>
  </body>
</html>
